<!DOCTYPE html>
<!-- saved from url=(0044)https://master.tech-camp.in/curriculums/3330 -->
<html lang="ja" class=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style type="text/css">@charset "UTF-8";[ng\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\:form{display:block;}</style><script type="text/javascript" async="" src="./3330_files/js"></script><script type="text/javascript" async="" src="./3330_files/analytics.js"></script><script async="" src="./3330_files/analytics.js"></script><script type="text/javascript" async="" charset="utf-8" src="./3330_files/tracker.js"></script><script async="" src="./3330_files/analytics.js"></script><script async="" src="./3330_files/gtm.js"></script><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-WSQ5HQW');</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-117266470-1', 'auto', {allowLinker: true});
ga('require', 'GTM-5ZZL9PL');</script><style type="text/css">.async-hide{opacity:0 !important}</style><script>(function(a,s,y,n,c,h,i,d,e){s.className+=' '+y;h.start=1*new Date;
h.end=i=function(){s.className=s.className.replace(RegExp(' ?'+y),'')};
(a[n]=a[n]||[]).hide=h;setTimeout(function(){i();h.end=null},c);h.timeout=c;
})(window,document.documentElement,'async-hide','dataLayer',4000,
{'GTM-5ZZL9PL':true});</script><title></title><link href="./3330_files/application-ced2dc72cad02affb5e2001c812699a76c2e2c9a16f7e46fde7b8fe4fbedeece.css" media="all" rel="stylesheet"><script src="./3330_files/bundle.app-a1483610a8e212057ae9b8d7d243b8d8e6d8bc0ceb41f14509729ac931020eed.js"></script><link href="./3330_files/icon.css" rel="stylesheet"><meta content="authenticity_token" name="csrf-param">
<meta content="8myEhiSkZlggwKS72yKlNgBWS5u1OFVZnz+ObFA0qcc=" name="csrf-token"><link href="https://master.tech-camp.in/favicon.ico" rel="icon" sizes="16x16 32x32 48x48 128x128 256x256"><link href="./3330_files/font-awesome.min.css" rel="stylesheet"><link href="./3330_files/tiny-slider.css" rel="stylesheet"><script src="./3330_files/tiny-slider.js"></script><script>(function(){var t,e,r,n,a;for(t=function(){var t;return t=t||[],function(){var e,r,n,a;for(r=["init","start","stop","user","track","action","event","goal","chat","buy","page","view","admin","group","alias","ready","link","form","click","submit","cmd","emit","on","send","css","js","style","option","get","set","collection"],e=function(e){return function(){return t.push([e].concat(Array.prototype.slice.call(arguments,0)))}},n=0,a=[];n<r.length;)t[r[n]]=e(r[n]),a.push(n++);return a}(),t.init=function(e,r){var n,a;return t.api_key=e,t.options=r||{},a=document.createElement("script"),a.type="text/javascript",a.async=!0,a.charset="utf-8",a.src=t.options.tracker_url||"https://static.karte.io/libs/tracker.js",n=document.getElementsByTagName("script")[0],n.parentNode.insertBefore(a,n)},t},n=window.karte_tracker_names||["tracker"],e=0,r=n.length;r>e;e++)a=n[e],window[a]=t();tracker.init("7184e5e57be1c1617c52291a842d1411")}).call(this);</script><script>var karte = new window.Karte({"id":16457,"email":"a2c_sdvx@i.softbank.jp","proposal_id":null,"family_name":"古谷","first_name":"篤志","family_name_kana":"フルヤ","first_name_kana":"アツシ","email_address":null,"created_at":"2019-06-08T12:24:24.000+09:00","updated_at":"2019-08-09T17:14:49.000+09:00","admin":false,"permission":"student","group_id":null,"period_id":100093,"advance_flag":false,"coming":"go_out","course_id":32,"course_state":"during","image":{"url":"/uploads/noimage.png","mypage":{"url":"/uploads/noimage.png"},"navigation":{"url":"/uploads/noimage.png"},"large_image":{"url":"/uploads/noimage.png"}},"start_datetime":"2019-06-08T00:00:00.000+09:00","finish_datetime":"2019-12-21T00:00:00.000+09:00","skype_id":"live:47bb322ffce687b5","location":{"id":14,"name":"TECH::EXPERT 渋谷 エンジニアクラス","tc_location_id":14,"address":"東京都渋谷区道玄坂2丁目23−12 フォンティスビル7F","slack_shift_remind_channel":"#shift_remind_shibuya","slack_question_channel":"#expert_user_question","question_window":true,"questionnaire":false,"morning_cleaning_allowance":1000,"night_cleaning_allowance":500,"slack_ori_app_interview_remind_channel":"","original_application_interview_location_id":15,"slack_coming_guest_notification_channel":"#受付_exp渋谷_フォンティス","status":"expert","open_time":"2000-01-01T16:00:00.000+09:00","close_time":"2000-01-01T22:00:00.000+09:00","is_closed":false,"region":"kanto","calling_message":"下駄箱に靴を入れて頂き、\r\n左手にある自動販売機の前のテーブル席にお掛けになってお待ちください。","location_type":"school"},"style":"expert_weekend","location_id":14,"absence_days":0,"company_id":null,"company_admin":false,"mail_counter":0,"send_remind_mail":true,"pc":"mac","trigger_to_apply":null,"pass_confirmation":null,"interview_group_id":null,"coming_location_id":14,"trainer_id":null,"mentor_status":null,"will_show_mentoring_questionnaire":false,"is_blocked":false,"weekly_interview_mail_count":0,"send_weekly_interview_remind":true,"expert":true,"is_extending":false,"recent_join_datetime":null,"hide_first_interview_reserve":false,"is_target_of_individual_finished":false,"launch_oriapp":false,"state_of_first_orientation":"normal","authentication_token":"5j2HVUHFw-oyFizPznUi","welfare":false,"cuid":null}, null, {"id":100093,"name":"TECH::CAMP EXPERT 第56期","start_datetime":"2019-06-08T00:00:00.000+09:00","finish_datetime":"2019-08-30T00:00:00.000+09:00","term":56,"authentication_code":"","status":"during","period_type":"two_weeks","company_id":null,"week_count":null,"department_type":"expert","exp_study_style":null});
karte.setProfileTag();
karte.sendTraker();</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-33391559-9', 'auto');
ga('send', 'pageview');</script></head><body ng-app="techMaster" class="ng-scope"><noscript><iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-WSQ5HQW" style="display:none;visibility:hidden" width="0"></iframe></noscript><div class="header navbar main_header navbar-fixed-top" id="header" role="navigation"><div class="container"><div class="navbar-header"><button aria-controls="navbar" aria-expanded="false" class="navbar-toggle collapsed" data-target="#navbar" data-toggle="collapse" type="button"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="https://master.tech-camp.in/" target="_self"><img alt="TECH::MASTER" src="./3330_files/logo-a092b24686f2404f48e1ef25bd8bfe7445b458e4587da135059132b867b10cbd.svg"></a><span class="curri-search_container"><input data-curriculum-group-ids="[70, 513, 57, 514, 3, 2, 4, 5, 7, 8, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 27, 28, 29, 39, 42, 43, 44, 45, 46, 47, 48, 54, 54, 89, 113, 6, 614, 540, 258, 548, 205, 541, 542, 186, 204, 543, 544, 223, 545, 342, 546, 220, 224, 248, 250, 235, 295, 229, 249, 253, 270]" id="curri-search_input" placeholder="カリキュラム検索" type="text"><i aria-hidden="true" class="fa fa-search curri-search_icon"></i></span></div><div class="navbar-collapse collapse" id="navbar"><ul class="nav navbar-nav navbar-left"></ul><ul class="nav navbar-nav navbar-right"><li><p>終了まで<strong>134</strong>日</p></li><li id="course_navigation"><a class="dropdown" data-toggle="dropdown">コース<i aria-hidden="true" class="fa fa-caret-down"></i></a><ul class="dropdown-menu inner-list" id="course-list" style="overflow: auto;"><li class="course-item" data-id="48209"><a>EXPERT基礎カリキュラム（Mac）</a></li><li class="course-item bg-info" data-id="48210"><a>応用カリキュラム（ChatSpace）</a></li><li class="course-item" data-id="48211"><a>就職活動カリキュラム</a></li></ul></li><script>$(function() {
  var menuHeight = $(window).height() - 80;
  $('#js-menuheight').css('max-height', menuHeight + 'px');

  $('.js-switch-list').on('click', function(e) {
    e.stopPropagation();
    $('.js-list-group').toggle();
  });

  $('.js-course-select').on('click', function(e) {
    e.stopPropagation();
    var checkBox = $(this).find('input[type=checkbox]');
    checkBox.prop('checked', !checkBox.prop('checked'));
    $(this).hasClass('bg-info') ? $(this).removeClass('bg-info') : $(this).addClass('bg-info');
  });
});</script><li><p>ID:16457 古谷 篤志</p></li><li class="profileDropdown" data-target="#user-list"><a class="js-dropdown" id="profileDropdown"><img alt="古谷 篤志" class="avatar" src="./3330_files/noimage.png"><i aria-hidden="true" class="fa fa-caret-down"></i></a><ul class="inner-list" id="user-list" style="display: none;"><li><a href="https://master.tech-camp.in/me" target="_self">アカウント</a></li><li><a href="https://master.tech-camp.in/inqueries/new" target="_blank">お問い合わせ</a></li><li><a href="https://tech-camp.in/expert/faq" target="_blank">FAQ</a></li></ul></li><script>$(function() {
  $('#profileDropdown').on('click', function() {
    $('.popover').toggle();
  });
});</script></ul></div><div class="curri-search-res_container" style="display: none;"><div id="curri-search-res_box"></div></div></div></div><div id="toggle_navigation_banners"><input checked="checked" class="toggle_input" id="toggle" name="toggle" type="checkbox"><label class="toggle_label" for="toggle">お知らせ</label><div class="navigation_banners"><div class="navigation-banner"><div class="container"><div class="navbar-header"><span class="banner-icon banner-icon-notice">お知らせ</span>プロのエンジニアになって自分の技術で稼げる人材になりませんか？TECH::CAMP受講生は<strong>10万円OFF</strong>で受講できます！詳しくは<a class="banner-link" href="https://tech-camp.in/expert/campaign/tech_camp/?utm_campaign=none&amp;utm_medium=header&amp;utm_source=tech_master" target="_blank">こちら</a>をご確認ください。</div></div></div><div class="navigation-banner"><div class="container"><div class="navbar-header"><span class="banner-icon banner-icon-notice">お知らせ</span>新しいオンライン質問機能が公開されました。<a class="banner-link" href="https://master.tech-camp.in/curriculums/2988">詳しくはこちらのカリキュラムをお読みください。</a></div></div></div><div class="navigation-banner"><div class="container"><div class="navbar-header"><span class="banner-icon banner-icon-notice">お知らせ</span>下記の日時において定休日とし、より良い学習環境提供のために社員研修を実施いたします。そのため、13時以降のメンターへの質問（オンライン・教室質問）を停止させていただきます。 ※教室のご利用は可能でございます。  2019年8月30日(金)、2019年9月27日(金)、2019年11月1日(金)、2019年11月29日(金)、2019年12月27日(金)</div></div></div></div></div><!-- ngView:  --><div autoscroll="" ng-view="" class="ng-scope"><curriculum class="ng-scope" style="display: inline;">
  <div class="container" id="curriculum">
    <div class="row curriculum-inner">
      <div class="col-lg-12 main" ng-init="init()">
        <div class="page-header page ng-hide" style="background-image: url()" ng-show="curriculum.image">
  <h1 class="ng-binding">
    ChatSpace インクリメンタルサーチ実装<small class="ng-binding">〜〜</small>
  </h1>
  <!-- ngIf: curriculum.image.description.length -->
</div>
      </div>
      <div class="col-md-9 col-sm-12" id="curriculumMainContainer">
        <div class="curriculum_content">
          <div class="curriculum_text ng-scope" compile-progress-notifier="willCompiledCurriculumText" ng-controller="CurriculumHintController"><h1 class="ng-scope" id="1">本カリキュラムについて</h1>

<p class="ng-scope">グループ作成または編集時においてユーザー名を検索できるようにします。前章と同じく、APIを作成してリアルタイムでユーザー検索が行えるようにしましょう。こちらのカリキュラムでの実装は、実装が完了したらコードレビュー依頼してLGTMを貰う必要があります。<code>LGTMが出るまで次のカリキュラムには進まないでください。</code></p>

<h2 class="ng-scope" id="2">本カリキュラムの目標</h2>

<ul class="ng-scope">
<li>ユーザー検索をインクリメンタルサーチで行えるようにする</li>
</ul>

<h1 class="ng-scope" id="3">インクリメンタルサーチを実装しよう</h1>

<p class="ng-scope">次にグループ画面でのユーザー検索をインクリメンタルサーチで検索できるようにしましょう。</p>

<p class="ng-scope"><strong>インクリメンタルサーチは、以下の画像のように文字が入力されるごとに検索をかけ、結果を表示できる仕組みのことです。</strong></p>

<p class="ng-scope"><img src="./3330_files/e9e60484b57f71f62ff0072f34cead74.gif" alt="https://tech-master.s3.amazonaws.com/uploads/curriculums//e9e60484b57f71f62ff0072f34cead74.gif"></p>

<p class="ng-scope">インクリメンタルサーチを実装するため、流れを簡単に動画で説明します。<br>
<iframe width="560" height="430" src="./3330_files/HToTv6C8WVw.html" frameborder="0" allowfullscreen=""></iframe></p>

<h2 class="ng-scope" id="4">インクリメンタルサーチ実装のステップ</h2>

<p class="ng-scope">1.作業用のブランチを作成する<br>
2. ルーティングなどAPI側の準備をする<br>
3. テキストフィールドを作成する<br>
4. テキストフィールドに入力されるたびにイベントが発火するようにする<br>
5. イベント時に非同期通信できるようにする<br>
6. 非同期通信の結果を得て、HTMLを作成する<br>
7. 5で作成したHTMLをビュー上に追加する<br>
8. エラー時の処理を行う</p>

<h3 class="ng-scope">1.作業用のブランチを作成する</h3>

<p class="ng-scope">メッセージの非同期化の時と同様に、作業を始める前は必ず作業用のブランチを作成しましょう。</p>

<h3 class="ng-scope">2. ルーティングなどAPI側の準備をする</h3>

<p class="ng-scope">ユーザーの検索を行うためのルーティングもアクションもまだ用意されていません。<br>
そのため、初めにルーティングを設定しましょう。<br>
ルーティングは、7つのアクションに従って作成するべきなので、今回は<code>users#index</code>を使うためのルーティングを設定してください。</p>

<p class="ng-scope">ルーティングの次は、コントローラを編集しましょう。<br>
アクションを定義し、非同期で通信されたユーザーを検索して一致するユーザーを取得してください。<br>
ユーザーを取得したら、jbuilderを使ってJavaScript側に返しましょう。<br>
今回は、複数のユーザーが格納された配列を返すようなjbuilderの記述にする必要があります。</p>

<h3 class="ng-scope">3. テキストフィールドを作成する</h3>

<p class="ng-scope"><code>collection_checkboxes</code>を使ってユーザーを選択してきましたが、それもここからは使いません。<br>
ユーザー検索用に文字を打ち込めるテキストフィールドを作成しましょう。</p>

<p class="ng-scope">以下のHTMLをHamlに変換して使用してください。collection_checkboxesが記載されている部分は削除しましょう。</p>

<div class="code-frame ng-scope" data-lang="html"><table class="highlighttable"><tbody><tr>
<td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td>
<td class="code">
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">'chat-group-form__field--left'</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">label</span> <span class="na">class</span><span class="o">=</span><span class="s">"chat-group-form__label"</span> <span class="na">for</span><span class="o">=</span><span class="s">"chat_group_チャットメンバーを追加"</span><span class="p">&gt;</span>チャットメンバーを追加<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">'chat-group-form__field--right'</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">'chat-group-form__search clearfix'</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">class</span><span class="o">=</span><span class="s">'chat-group-form__input'</span> <span class="na">id</span><span class="o">=</span><span class="s">'user-search-field'</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">'追加したいユーザー名を入力してください'</span> <span class="na">type</span><span class="o">=</span><span class="s">'text'</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">'user-search-result'</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>
</td>
</tr></tbody></table></div>

<h3 class="ng-scope">4. テキストフィールドに入力されるたびにイベントが発火するようにする</h3>

<p class="ng-scope">続いて、テキストフィールドに文字が入力されるたびにイベントが呼び出されるようにしましょう。<br>
「キーが入力される度」に合致するイベントは何かを調べて実装しましょう。<br>
記述できたら、キーが入力される度にイベントが呼ばれているかを<code>console.log</code>などを使用して確認しておきましょう。</p>

<h3 class="ng-scope">5. イベント時に非同期通信できるようにする</h3>

<p class="ng-scope">キーが入力される度に非同期通信でユーザーを検索できるようにしましょう。<br>
2で設定したルーティングにアクセスして、コントローラで該当するユーザーを検索しましょう。<br>
うまくいっている場合は、該当するユーザーはjbuilderによってJSONに変換されて返されるはずです。</p>

<h3 class="ng-scope">6. 非同期通信の結果を得て、HTMLを作成する</h3>

<p class="ng-scope">5でユーザーを返せるところまで来ました。<br>
非同期通信の結果を<code>done</code>の関数の引数から受取り、ビューに追加するためのHTMLを作成する必要があります。<br>
<img src="./3330_files/baa3d6e217a833700071a851a5f77f77.png" alt="https://tech-master.s3.amazonaws.com/uploads/curriculums//baa3d6e217a833700071a851a5f77f77.png"></p>

<p class="ng-scope">作成するHTMLは、以下のようなHTMLをJavaScript側で使用してください。</p>

<div class="code-frame ng-scope" data-lang="html"><table class="highlighttable"><tbody><tr>
<td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td>
<td class="code">
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"chat-group-user clearfix"</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">"chat-group-user__name"</span><span class="p">&gt;</span>ユーザー名<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"user-search-add chat-group-user__btn chat-group-user__btn--add"</span> <span class="na">data-user-id</span><span class="o">=</span><span class="s">"ユーザーのid"</span> <span class="na">data-user-name</span><span class="o">=</span><span class="s">"ユーザー名"</span><span class="p">&gt;</span>追加<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>
</td>
</tr></tbody></table></div>

<h3 class="ng-scope">7. 6で作成したHTMLをビュー上に追加する</h3>

<p class="ng-scope">6でHTMLを組み立てることができたら、ビューに追加しましょう。<br>
メッセージ送信機能でも行っているので簡単ですね。</p>

<h3 class="ng-scope">8. エラー時の処理を行う</h3>

<p class="ng-scope">最後に通信に失敗した場合の処理を実装しましょう。<br>
アラートで「ユーザー検索に失敗しました」と表示ができれば十分です。</p>

<h1 class="ng-scope" id="5">インクリメンタルサーチの後について</h1>

<p class="ng-scope">インクリメンタルサーチを実装できても終わりではありません。<br>
該当するユーザーの中から追加したいユーザーを選択できるようにする必要があります。<br>
つまり、更新ボタンを押したときに追加を押されたユーザーが<code>params</code>に含まれるように実装する必要があります。</p>

<p class="ng-scope"><img src="./3330_files/c7660ed911cf48e339062c3167440631.png" alt="https://tech-master.s3.amazonaws.com/uploads/curriculums//c7660ed911cf48e339062c3167440631.png"></p>

<p class="ng-scope">流れを簡単に動画で説明します。<br>
<iframe width="560" height="430" src="./3330_files/OKXrVdhvcRM.html" frameborder="0" allowfullscreen=""></iframe></p>

<h2 class="ng-scope" id="6">インクリメンタルサーチ後の実装のステップ</h2>

<ol class="ng-scope">
<li>追加ボタンが押されたときにイベントが発火するようにする</li>
<li>追加ボタンをクリックされたユーザーの名前を、チャットメンバーの部分に追加し、検索結果からは消す</li>
<li>削除を押すと、チャットメンバーから削除される</li>
<li>編集画面では既存のユーザーが追加済みの状態であることを確認する</li>
</ol>

<h3 class="ng-scope">1. 追加ボタンが押されたときにイベントが発火するようにする</h3>

<p class="ng-scope">まずは、追加ボタンが押されたときに<code>click</code>イベントが発火するようにしましょう。<br>
今回イベントを発火させたい要素は、ビューのローディング時には存在していないHTML要素なので、通常通り<code>$(セレクタ).on('click', function(){ 処理 })</code>としても動きません。<br>
後から追加された要素に対してイベントを設定するにはどうしたら良いのでしょうか？<br>
調べて実装してみましょう。</p>

<h3 class="ng-scope">2.  追加ボタンをクリックされたユーザーの名前を、チャットメンバーの部分に追加し、検索結果からは消す</h3>

<p class="ng-scope">「追加」ボタンがクリックされた時に、<code>click</code>イベントを発火させます。以下の2点を実装しましょう。<br>
①「追加」ボタンがクリックされたユーザーが、検索結果一覧から消える<br>
②「追加」ボタンがクリックされたユーザーが、チャットメンバーの方に追加される</p>

<p class="ng-scope">※上記のままだと、再度検索を行うと追加済みユーザーが検索されてしまいます。これを避けるようにする実装は、ChatSpaceの全ての実装が終わった後、余裕があれば行ってください。<br>
以下のようなHTMLを生成するように、JavaScriptを実装してください。<br>
生成したHTMLは、ビューに追加しましょう。</p>

<div class="code-frame ng-scope" data-lang="html"><table class="highlighttable"><tbody><tr>
<td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td>
<td class="code">
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">'chat-group-user'</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">input</span> <span class="na">name</span><span class="o">=</span><span class="s">'group[user_ids][]'</span> <span class="na">type</span><span class="o">=</span><span class="s">'hidden'</span> <span class="na">value</span><span class="o">=</span><span class="s">'ユーザーのid'</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">'chat-group-user__name'</span><span class="p">&gt;</span>ユーザー名<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">'user-search-remove chat-group-user__btn chat-group-user__btn--remove js-remove-btn'</span><span class="p">&gt;</span>削除<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>
</td>
</tr></tbody></table></div>

<h3 class="ng-scope">3. 削除を押すと、チャットメンバーから削除される</h3>

<p class="ng-scope">間違えて追加を押してしまったユーザーがいるかもしれません。<br>
そのような場合に備えて、削除を押したらビューからHTMLを取り除くようにしましょう。</p>

<h3 class="ng-scope">4. 編集画面では既存のユーザーが追加済みの状態であることを確認する</h3>

<p class="ng-scope">編集画面にアクセスした時に、既にグループに追加されているユーザーは、最初から追加済みの状態であるようにしましょう。</p>

<h4 class="ng-scope">良い例</h4>

<p class="ng-scope">既存ユーザー（testさん、testくん）は編集画面でもすでにチャットメンバーとして存在している。<br>
<img src="./3330_files/87ca03dbabbda6ee142ef50c0dbaae60.gif" alt="https://i.gyazo.com/87ca03dbabbda6ee142ef50c0dbaae60.gif"></p>

<h4 class="ng-scope">悪い例</h4>

<p class="ng-scope">既存ユーザー（testくん）が編集画面に遷移すると、チャットメンバーからは外されてしまっている。このまま「更新する」ボタンをクリックすると、testくんはチャットメンバーから外されたまま更新されてしまいます。<br>
<img src="./3330_files/955b9e0c5c7cc62bfffa5f4f91a93491.gif" alt="https://i.gyazo.com/955b9e0c5c7cc62bfffa5f4f91a93491.gif"></p>

<p class="ng-scope">これは、JavaScriptではなく、フォームが記載されているビューファイル（_form.html.haml）を修正することで実装できます。</p>

<h1 class="ng-scope" id="7">コードレビューを依頼しよう</h1>

<h3 class="ng-scope">
<i class="icon pen"></i> コードレビューを依頼する前に確認しよう</h3>

<p class="ng-scope">ここまででインクリメンタルサーチの部分は終了になります。以下を確認しましょう。</p>

<div class="code-frame ng-scope" data-lang="bash">
<div class="code-lang"><span class="bold">実装内容について</span></div>
<table class="highlighttable"><tbody><tr>
<td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td>
<td class="code">
<div class="highlight"><pre><span></span>Controllerからhtmlをレスポンスとするコードを削除しても問題なく動作するか（非同期通信がそもそも出来ているのか）
適切にインクリメンタルサーチできるか
自分が検索結果に表示されないようになっているか
自分がデフォルトでチャットメンバーに追加されるようになっているか
追加ボタンを押したらチャットメンバーに追加されるか
削除ボタンを押したらチャットメンバーから削除されるか
関数名は処理の内容を過不足なく表現できるような名前になっているか
変数名はデータの内容を過不足なく表現できるような名前になっているか
グループ新規作成が正常に行われるか（追加したユーザー全員がグループのメンバーとなるか）
グループの編集が行えるか（編集画面移行時に、既存ユーザーが削除されないか）
binding.pryやconsole.logなどのデバッグ用の記載は消去してあるか
コードのインデントは適切に取ってあるか（全角スペースはNGです）
</pre></div>
</td>
</tr></tbody></table>
</div>

<div class="code-frame ng-scope" data-lang="bash">
<div class="code-lang"><span class="bold">プルリクエストの作成について</span></div>
<table class="highlighttable"><tbody><tr>
<td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td>
<td class="code">
<div class="highlight"><pre><span></span>プルリクエストが正しく作られているか
プルリクエストにWhy/Whatを記載してあるか
プルリクエストのWhy/Whatにマークダウンが適用されているか
実際の動きを示すgifの動画キャプチャを添付できているか
</pre></div>
</td>
</tr></tbody></table>
</div>

<p class="ng-scope">上記が確認できたら、コードレビューを依頼しましょう。</p>

<h3 class="ng-scope">
<i class="icon pen"></i> コードレビューを依頼しよう</h3>

<p class="ng-scope">プルリクエストの[WIP]を外して、フォームからコードレビューを依頼しましょう。メッセージの非同期投稿とは別のプルリクエストを作成していることを確認してください。この時、<a href="https://gyazo.com/about?lang=ja">Gyazo gif</a>などを利用してgifの動画キャプチャを添付してください。</p>

<p class="ng-scope"><strong>プルリクエストにLGTMが出たら、</strong>マージして新たにブランチを作成し、次の自動更新機能に進んでください。</p>
</div>
          <!-- ngIf: curriculum.short_test -->
          <section class="progress-checker text-center" ng-init="init()">
  <h3>このカリキュラムの理解度を教えてください</h3>
  <h4>ボタンを押していただくと次へ進めます</h4>
  <div class="progress-checker-buttons">
    <ul>
      <li id="progress-not_surely" class="red" ng-click="send_state(&#39;not_surely&#39;)"></li>
      <li id="progress-well" class="blue" ng-click="send_state(&#39;well&#39;)"></li>
      <li id="progress-perfectly" class="green" ng-click="send_state(&#39;perfectly&#39;)"></li>
    </ul>
  </div>
  <ul class="curriculum-router-buttons">
    <li class="previous-button" ng-show="curriculum.previous_id" style="">
      <a ng-click="go_previous()">&lt;&lt;前のカリキュラム</a>
    </li>
    <li class="next-button disabled" ng-show="curriculum.next_id" style="">
      <a ng-click="go_next()">次のカリキュラム&gt;&gt;</a>
    </li>
  </ul>
</section>
          <section class="progress-share bg_icon-pattern text-center">
            <h1 class="progress-share_title" id="8">お疲れさまです！</h1>
            <p>
              <strong class="ng-binding">
                ChatSpace インクリメンタルサーチ実装
              </strong>
              はここまでです。
              <br>
              SNSで学習の進み具合を友達にシェアしてみましょう！
            </p>
            <div class="progress-share_actions">
              <a href="https://twitter.com/intent/tweet/?text=TECH%3A%3ACAMP%E3%81%A7%E3%80%8CChatSpace+%E3%82%A4%E3%83%B3%E3%82%AF%E3%83%AA%E3%83%A1%E3%83%B3%E3%82%BF%E3%83%AB%E3%82%B5%E3%83%BC%E3%83%81%E5%AE%9F%E8%A3%85%E3%80%8D%E3%81%AE%E5%AD%A6%E7%BF%92%E3%82%92%E4%BF%AE%E4%BA%86%E3%81%97%E3%81%BE%E3%81%97%E3%81%9F%EF%BC%81+%23%E3%83%86%E3%83%83%E3%82%AF%E3%82%AD%E3%83%A3%E3%83%B3%E3%83%97+%23%E3%83%86%E3%83%83%E3%82%AF%E3%82%AD%E3%83%A3%E3%83%B3%E3%83%97%E3%81%A7%E5%8B%89%E5%BC%B7%E3%81%AA%E3%81%86+&amp;url=https%3A%2F%2Ftech-camp.in" class="twitter" target="_blank">
                <img class="icon twitter-icon" src="./3330_files/icon-twitter.svg" alt="">
                Twitterでシェア
              </a>
              <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Ftech-camp.in" class="facebook" target="_blank">
              <img class="icon facebook-icon" src="./3330_files/icon-facebook.svg" alt="">
                Facebookでシェア
              </a>
            </div>
          </section>
        </div>
      </div>
      <div class="col-md-3 col-sm-12" id="curriculumSideContainer">
        <curriculum-side-wrap id="sideWrap" class="fixed-side" style="width: 270px;">
          <ul class="list-group toc-tree" id="curriculumContents" style="max-height: 475px;">
  <li class="list-group-item disabled">
    目次
  </li>
  <!-- ngRepeat: content in contents --><li ng-repeat="content in contents" class="ng-scope">
    <a class="content-link ng-binding" id="contents1" ng-click="clickContent(content.h1.id)">本カリキュラムについて</a>
    <ul class="list-group">
      <!-- ngRepeat: h2 in content.h2 track by $index --><li ng-repeat="h2 in content.h2 track by $index" class="ng-scope">
        <a class="content-link ng-binding" id="contents2" ng-click="clickContent(h2.id)">本カリキュラムの目標</a>
      </li><!-- end ngRepeat: h2 in content.h2 track by $index -->
    </ul>
  </li><!-- end ngRepeat: content in contents --><li ng-repeat="content in contents" class="ng-scope">
    <a class="content-link ng-binding" id="contents3" ng-click="clickContent(content.h1.id)">インクリメンタルサーチを実装しよう</a>
    <ul class="list-group">
      <!-- ngRepeat: h2 in content.h2 track by $index --><li ng-repeat="h2 in content.h2 track by $index" class="ng-scope">
        <a class="content-link ng-binding current" id="contents4" ng-click="clickContent(h2.id)">インクリメンタルサーチ実装のステップ</a>
      </li><!-- end ngRepeat: h2 in content.h2 track by $index -->
    </ul>
  </li><!-- end ngRepeat: content in contents --><li ng-repeat="content in contents" class="ng-scope">
    <a class="content-link ng-binding" id="contents5" ng-click="clickContent(content.h1.id)">インクリメンタルサーチの後について</a>
    <ul class="list-group">
      <!-- ngRepeat: h2 in content.h2 track by $index --><li ng-repeat="h2 in content.h2 track by $index" class="ng-scope">
        <a class="content-link ng-binding" id="contents6" ng-click="clickContent(h2.id)">インクリメンタルサーチ後の実装のステップ</a>
      </li><!-- end ngRepeat: h2 in content.h2 track by $index -->
    </ul>
  </li><!-- end ngRepeat: content in contents --><li ng-repeat="content in contents" class="ng-scope">
    <a class="content-link ng-binding" id="contents7" ng-click="clickContent(content.h1.id)">コードレビューを依頼しよう</a>
    <ul class="list-group">
      <!-- ngRepeat: h2 in content.h2 track by $index -->
    </ul>
  </li><!-- end ngRepeat: content in contents --><li ng-repeat="content in contents" class="ng-scope">
    <a class="content-link ng-binding" id="contents8" ng-click="clickContent(content.h1.id)">お疲れさまです！</a>
    <ul class="list-group">
      <!-- ngRepeat: h2 in content.h2 track by $index -->
    </ul>
  </li><!-- end ngRepeat: content in contents -->
</ul>
          <div class="progress_box ng-scope ng-hide" ng-show="check_count &gt; 0" style="">
  <!-- ngIf: showTroubleShooting() -->
  <!-- <p class="terms" ng-if="courseId != 9 && courseId != 10">
    分からない用語がある時：<br /><a href="/terms" target="_brank">用語一覧集</a>
  </p> -->
  <h4>
    進捗度<i id="numerator" class="ng-binding">0 / 0<span id="denominaotr"></span></i>
  </h4>
  <div class="progress">
    <div aria-valuemax="100" aria-valuemin="0" aria-valuenow="0" class="pregress-bar progress-bar-info ng-binding" role="progressbar" style="width: 0%;">
      0%
    </div>
  </div>
</div>
          <!-- <curriculum-glossary ng-show="curriculum.curriculum_type == 2 || curriculum.curriculum_type == 3"></curriculum-glossary> -->
          <button class="curriculum-report-button" ng-click="show_curriculum_report()">
            <img src="./3330_files/idea.svg" width="20px" height="20px">
            | このカリキュラムへのご要望
          </button>
        </curriculum-side-wrap>
      </div>
    </div>

    <!-- <curriculum-footer></curriculum-footer> -->
  </div>
</curriculum>
<div id="loading" ng-show="loading" class="ng-scope ng-isolate-scope ng-hide" style="">
  <svg height="44" stroke="#444" viewBox="0 0 44 44" width="44" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd" strole-width="2"><circle cx="22" cy="22" r="19.9827"><animate attributeName="r" begin="0s" calcMode="spline" dur="1.8s" keySplines="0.165, 0.84, 0.44, 1" keyTimes="0; 1" repeatCount="indefinite" values="1; 20"></animate><animate attributeName="stroke-opacity" begin="0s" calcMode="spline" dur="1.8s" keySplines="0.3, 0.61, 0.355, 1" keyTimes="0; 1" repeatCount="indefinite" values="1; 0"></animate></circle><circle cx="22" cy="22" r="17.6246"><animate attributeName="r" begin="-0.9s" calcMode="spline" dur="1.8s" keySplines="0.165, 0.84, 0.44, 1" keyTimes="0; 1" repeatCount="indefinite" values="1; 20"></animate><animate attributeName="stroke-opacity" begin="-0.9s" calcMode="spline" dur="1.8s" keySplines="0.3, 0.61, 0.355, 1" keyTimes="0; 1" repeatCount="indefinite" values="1; 0"></animate></circle></g></svg>
</div>

<div class="curriculum-image__modal modal ng-scope" id="curriculum-image__modal" role="dialog" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button class="close" data-dismiss="modal" ng-click="close()"><span aria-hidden="true">×</span></button>
      </div>
      <div class="modal-body">
        <div class="curriculum-image__img__body">
          <img class="curriculum-image__img zoom-out" id="curriculum-image__img">
        </div>
      </div>
    </div>
  </div>
</div>

<style type="text/css" class="ng-scope">
  .curriculum-inner{position: relative;}
  #curriculumSideContainer{position: static;}
  #sideWrap{display: block;}
  .fixed-side{position: fixed; top :110px}
  .absoluted-side-bottom{position: absolute; bottom :0}
  .toc-tree{position: relative; overflow-y: auto;}
  .content-link {cursor: pointer;}
</style>

<script class="ng-scope">
  $(function(){
    var url = location.href
    $.ajax({
      url: url + '/save_watch_log',
      type: 'POST'
    })
  });
</script>
</div><div id="js-support-popwindow"><div class="chat-window"><div class="chat-dock__wrapper chat-dock__show-off chat-dock__wrapper__hidden" style="bottom: -111px;"><div class="chat-dock__hide-btn"><i class="fa fa-arrow-up" id="hide-btn-chevron"></i><span> 出席ボタンを表示する</span></div><div class="chat-dock"><div class="coming-box"><div class="current_status-label present">退席中</div><div class="come_in-btn current_status-label">入り口で出席管理を <br>
お願いいたします。</div></div><a class="chat-btn" href="https://master.tech-camp.in/connect/mentor" style="margin-bottom:8px;border-radius:3px;" target="_blank">質問サポート</a></div></div></div></div></body></html>